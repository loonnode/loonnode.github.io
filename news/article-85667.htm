<!DOCTYPE html>
<html xml:lang="zh-CN" lang="zh-CN">

<head>
        <link rel="canonical" href="https://loonnode.github.io/news/article-85667.htm" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>多层感知机实现</title>
        <meta name="description" content="前面利用了softmax来对图像进行分类，也可以使用多层感知机的方法对图像进行分类。 多层感知机从零开始实现方法   多层感知机（  multilayer perceptron  ，  MLP），在单" />
        <link rel="icon" href="/assets/website/img/loonnode/favicon.ico" type="image/x-icon"/>

    <meta name="author" content="Loon Node机场订阅官网">
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://loonnode.github.io/news/article-85667.htm" />
    <meta property="og:site_name" content="Loon Node机场订阅官网" />
    <meta property="og:title" content="多层感知机实现" />
    <meta property="og:image" content="https://loonnode.github.io/uploads/20240719/b9485d8d5d0cbcf11f3f5346b090ac06.webp" />
        <meta property="og:release_date" content="2025-03-31T08:43:25" />
    <meta property="og:updated_time" content="2025-03-31T08:43:25" />
        <meta property="og:description" content="前面利用了softmax来对图像进行分类，也可以使用多层感知机的方法对图像进行分类。 多层感知机从零开始实现方法   多层感知机（  multilayer perceptron  ，  MLP），在单" />
    
    <meta name="applicable-device" content="pc,mobile" />
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta name="robots" content="max-image-preview:large" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="多层感知机实现">
    <meta name="format-detection" content="telephone=no">

    <link rel="dns-prefetch" href="https:/www.googletagmanager.com">
    <link rel="dns-prefetch" href="https://www.googleadservices.com">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="https://pagead2.googlesyndication.com">
    <link rel="dns-prefetch" href="https://cm.g.doubleclick.net">
        
    <!-- Bootstrap -->
    <link href="/assets/website/css/loonnode/bootstrap.min.css" rel="stylesheet">
    <!-- Style CSS -->
    <link href="/assets/website/css/loonnode/style.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i%7cNoto+Serif:400,400i,700,700i" rel="stylesheet">
    <!-- FontAwesome CSS -->
    <link href="/assets/website/js/frontend/loonnode/web-fonts-with-css/css/fontawesome-all.css" rel="stylesheet">
    <!-- OwlCarosuel CSS -->
    <link href="/assets/website/css/loonnode/owl.carousel.css" type="text/css" rel="stylesheet">
    <link href="/assets/website/css/loonnode/owl.theme.default.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/website/css/loonnode/aos.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2X9J5FVHVS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2X9J5FVHVS');
</script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3332997411212854"
     crossorigin="anonymous"></script>
</head>

<body data-page="detail">
        <!-- header-section-->
    <div class="header-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-xl-5 col-lg-3 col-md-12 col-sm-12 col-12">
                <div class="logo">
                    <a href="/">
                                        <span>Loon Node</span>
                                        </a>
                </div>
                </div>
                <div class="col-xl-7 col-lg-9 col-md-12 col-sm-12 col-12">
                    <!-- navigations-->
                    <div class="navigation">
                        <div id="navigation">
                            <ul>
                                                                <li><a href="/">首页</a></li>
                                                                <li><a href="/free-nodes/">免费节点</a></li>
                                                                <li><a href="/paid-subscribe/">推荐机场</a></li>
                                                                <li><a href="/client.htm">客户端</a></li>
                                                                <li><a href="/news/">新闻资讯</a></li>
                                                            </ul>
                        </div>
                    </div>
                    <!-- /.navigations-->
                </div>
            </div>
        </div>
    </div>
    <!-- /. header-section-->
    <!-- page-header -->
    <div class="page-header">
        <div class="container">
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                    <div data-aos="fade-up" class="page-caption">
                        <h1 class="page-title">多层感知机实现</h1>
                        <div class="nav-box">
                            <a href="/">首页</a> / <a href="/news/">新闻资讯</a> / <span>正文</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.page-header-->
    <!-- attorney-section -->
    <div class="space-medium bg-light">
        <div class="container">
            <div class="row">
                <div class="col-md-9">
                                    <input type="hidden" id="share-website-info" data-name="" data-url="">
                  				  				  				<div id="content_views" class="htmledit_views"> <p>前面利用了softmax来对图像进行分类，也可以使用多层感知机的方法对图像进行分类。</p> <h2>多层感知机从零开始实现方法</h2> <div>  <span style="color:#333333;">多层感知机（</span><br />  <span style="color:#333333;">multilayer perceptron</span><br />  <span style="color:#333333;">，</span><br />  <span style="color:#333333;">MLP），在单层神经网络的基础上引入了一到多个隐藏层（hidden layer）。</span> </div> <div>  &nbsp; </div> <div>  <img fetchpriority="high" decoding="async" alt="" class="has" height="291" src="http://img.555519.xyz/uploads/20230119/db5359c93b00af5beb1b924cfa0d4502.jpg"> </div> <div>  &nbsp; </div> <div>  对于图中的感知机来说，<br />  <span style="color:#333333;">它含有一个隐藏层，该层中有</span><br />  <span style="color:#333333;">5个隐藏单元。输入和输出个数分别为</span><br />  <span style="color:#333333;">4</span><br />  <span style="color:#333333;">和</span><br />  <span style="color:#333333;">3</span><br />  <span style="color:#333333;">，中间的隐藏层中包含了</span><br />  <span style="color:#333333;">5个隐藏单元。由于输入层不涉及计算，图</span><br />  <span style="color:#333333;">中的多层感知机的层数为</span><br />  <span style="color:#333333;">2</span><br />  <span style="color:#333333;">。 </span> </div> <div>  <span style="color:#333333;">隐藏层位于输入层和输出层之间。</span><br />  <span style="color:#333333;">隐藏层中</span><br />  <span style="color:#333333;">的神经元和输入层中各个输入完全连接，输出层中的神经元和隐藏层中的各个神经元也完全连接。因</span><br />  <span style="color:#333333;">此，多层感知机中的隐藏层和输出层都是全连接层。</span> </div> <div>  &nbsp; </div> <h3>1.导入包</h3> <pre class="has"><code class="language-python">import torch import numpy as np import sys sys.path.append("..") # 为了导入上层目录的d2lzh_pytorch import d2lzh_pytorch as d2l  print(torch.__version__)</code></pre> <h3>2.获取和读取数据</h3> <div>  <span style="color:#333333;">使用</span><br />  <span style="color:#333333;">Fashion-MNIST</span><br />  <span style="color:#333333;">数据集。我们将使用多层感知机对图像进行分类。 </span> </div> <pre class="has"><code class="language-python">batch_size = 256 train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)</code></pre> <h3>3.定义模型参数</h3> <div>  <span style="color:#333333;">Fashion-MNIST</span><br />  <span style="color:#333333;">数据集中图像形状为 28x28，类别数为10</span><br />  <span style="color:#333333;">。本节中我们依然使用长度为 28x28=784的向量表示每一张图像。因此，输入个数为784</span><br />  <span style="color:#333333;">，输出个数为</span><br />  <span style="color:#333333;">10</span><br />  <span style="color:#333333;">。实验中，我们设超参数隐藏单元个数为</span><br />  <span style="color:#333333;">256</span><br />  <span style="color:#333333;">。 </span> </div> <pre class="has"><code class="language-python">num_inputs, num_outputs, num_hiddens = 784, 10, 256  W1 = torch.tensor(np.random.normal(0, 0.01, (num_inputs, num_hiddens)), dtype=torch.float) b1 = torch.zeros(num_hiddens, dtype=torch.float) W2 = torch.tensor(np.random.normal(0, 0.01, (num_hiddens, num_outputs)), dtype=torch.float) b2 = torch.zeros(num_outputs, dtype=torch.float)  params = [W1, b1, W2, b2] for param in params:     param.requires_grad_(requires_grad=True)</code></pre> <h3>4.定义激活函数</h3> <div>  <span style="color:#333333;">使用基础的 </span><br />  <span style="color:#333333;">max </span><br />  <span style="color:#333333;">函数来实现</span><br />  <span style="color:#333333;">ReLU</span><br />  <span style="color:#333333;">，而非直接调用 </span><br />  <span style="color:#333333;">relu </span><br />  <span style="color:#333333;">函数。 </span> </div> <pre class="has"><code class="language-python">def relu(X):     return torch.max(input=X, other=torch.tensor(0.0))</code></pre> <h3>5.定义模型</h3> <div>  <span style="color:#333333;">通过 </span><br />  <span style="color:#333333;">view </span><br />  <span style="color:#333333;">函数将每张原始图像改成长度为 </span><br />  <span style="color:#333333;">num_inputs </span><br />  <span style="color:#333333;">的向量。然后我们实现上一节中多层感知机的计算表达式。 </span> </div> <pre class="has"><code class="language-python">def net(X):     X = X.view((-1, num_inputs))     H = relu(torch.matmul(X, W1) + b1)     return torch.matmul(H, W2) + b2</code></pre> <h3>6.定义损失函数</h3> <div>  <span style="color:#333333;">直接使用</span><br />  <span style="color:#333333;">PyTorch</span><br />  <span style="color:#333333;">提供的包括</span><br />  <span style="color:#333333;">softmax运算和交叉熵损失计算的函数。 </span> </div> <pre class="has"><code class="language-python">loss = torch.nn.CrossEntropyLoss()</code></pre> <h3>7.训练模型</h3> <pre class="has"><code class="language-python">num_epochs, lr = 5, 100.0 d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, batch_size, params, lr)</code></pre> <p><img decoding="async" alt="" class="has" height="105" src="http://img.555519.xyz/uploads/20230119/99c32180a6cada77646c3ad78dae6a11.jpg"></p> <h2>简洁实现的方法：</h2> <h3>1.定义模型</h3> <pre class="has"><code class="language-python">num_inputs, num_outputs, num_hiddens = 784, 10, 256      net = nn.Sequential(         d2l.FlattenLayer(),         nn.Linear(num_inputs, num_hiddens),         nn.ReLU(),         nn.Linear(num_hiddens, num_outputs),          )      for params in net.parameters():     init.normal_(params, mean=0, std=0.01)</code></pre> <h3>2.读取数据并训练模型</h3> <pre class="has"><code class="language-python">batch_size = 256 train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size) loss = torch.nn.CrossEntropyLoss()  optimizer = torch.optim.SGD(net.parameters(), lr=0.5)  num_epochs = 5 d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, batch_size, None, None, optimizer)</code></pre> <p>&nbsp;</p> </p></div> 			                <div class="clearfix"></div>
                <div class="col-md-12 mt-5">
                                        <p>上一个：<a href="/news/article-84960.htm">安安宠医上班时间（安安宠物医院招聘网）</a></p>
                                        <p>下一个：<a href="/news/article-85668.htm">开个宠物粮加工厂怎么样赚钱吗（宠物粮食加工厂需要执照吗）</a></p>
                                    </div>
                                </div>
                <div class="col-md-3">
                    <div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">热门文章</h3>
    </div>
    <div class="panel-body">
        <ul class="p-0 x-0" style="list-style: none;margin: 0;padding: 0;">
                        <li class="py-2"><a href="/free-nodes/2025-3-29-latest-loon-node.htm" title="「3月29日」每天更新21.7M/S，Clash/V2ray/SSR/Shadowrocket/Loon免费节点订阅链接">「3月29日」每天更新21.7M/S，Clash/V2ray/SSR/Shadowrocket/Loon免费节点订阅链接</a></li>
                        <li class="py-2"><a href="/news/article-75911.htm" title="宠物领养协议法律效力多少年 宠物领养协议法律效力多少年了">宠物领养协议法律效力多少年 宠物领养协议法律效力多少年了</a></li>
                        <li class="py-2"><a href="/news/article-35498.htm" title="宠物粮食品牌名字4个字大全图片及价格 宠物粮食品牌名字4个字大全图片及价格">宠物粮食品牌名字4个字大全图片及价格 宠物粮食品牌名字4个字大全图片及价格</a></li>
                        <li class="py-2"><a href="/news/article-46678.htm" title="北京宠物医院加盟（北京宠物加盟店）">北京宠物医院加盟（北京宠物加盟店）</a></li>
                        <li class="py-2"><a href="/news/article-60642.htm" title="天津宠物救助中心电话 天津宠物救助中心电话24小时">天津宠物救助中心电话 天津宠物救助中心电话24小时</a></li>
                        <li class="py-2"><a href="/news/article-69918.htm" title="动物医院实践心得5000字左右作文怎么写 动物医院实践心得5000字左右作文怎么写的">动物医院实践心得5000字左右作文怎么写 动物医院实践心得5000字左右作文怎么写的</a></li>
                        <li class="py-2"><a href="/free-nodes/2025-3-15-linux-loon-github.htm" title="「3月15日」每天更新21M/S，V2ray/Shadowrocket/Clash/SSR/Loon免费节点订阅链接">「3月15日」每天更新21M/S，V2ray/Shadowrocket/Clash/SSR/Loon免费节点订阅链接</a></li>
                        <li class="py-2"><a href="/free-nodes/2025-2-1-node-share-links.htm" title="「2月1日」每天更新21.4M/S，V2ray/Clash/Shadowrocket/SSR/Loon免费节点订阅链接">「2月1日」每天更新21.4M/S，V2ray/Clash/Shadowrocket/SSR/Loon免费节点订阅链接</a></li>
                        <li class="py-2"><a href="/free-nodes/2025-2-7-linux-loon-github.htm" title="「2月7日」每天更新18.7M/S，V2ray/SSR/Shadowrocket/Clash/Loon免费节点订阅链接">「2月7日」每天更新18.7M/S，V2ray/SSR/Shadowrocket/Clash/Loon免费节点订阅链接</a></li>
                        <li class="py-2"><a href="/news/article-67352.htm" title="动物接种注意事项包括（动物接种法的优缺点）">动物接种注意事项包括（动物接种法的优缺点）</a></li>
                    </ul>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">归纳</h3>
    </div>
    <div class="panel-body">
        <ul class="p-0 x-0" style="list-style: none;margin: 0;padding: 0;">
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">93</span> <a href="/date/2025-03/" title="2025-03 归档">2025-03</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">84</span> <a href="/date/2025-02/" title="2025-02 归档">2025-02</a></h4>
            </li>
                        <li class="py-2">
                <h4><span class="badge" style="float: right;">84</span> <a href="/date/2025-01/" title="2025-01 归档">2025-01</a></h4>
            </li>
                    </ul>
    </div>
</div>

                </div>
            </div>
        </div>
    </div>
    <!-- attorney-section -->
        <!-- footer -->
    <div class="footer">
        <div class="tiny-footer">
            <div class="container">
                <div class="row ">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 text-center ">
                            <p>
                                <a href="/">首页</a> | 
                                <a href="/free-node/">免费节点</a> | 
                                <a href="/news/">新闻资讯</a> |
                                <a href="/about-us.htm">关于我们</a> |
                                <a href="/disclaimer.htm">免责申明</a> |
                                <a href="/privacy.htm">隐私申明</a> |
                                <a href="/sitemap.xml">网站地图</a>
                            </p>
                        <p>
                            <a href="/">Loon Node机场订阅官网</a> 版权所有 Powered by WordPress
                        </p>
                    </div>
                </div>
                <!-- /. tiny-footer -->
            </div>
        </div>
    </div>
    <!-- /.footer -->
    <a href="javascript:" id="return-to-top"><i class="fa fa-angle-up"></i></a>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="/assets/website/js/frontend/loonnode/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/website/js/frontend/loonnode/bootstrap.min.js"></script>
    <script src="/assets/website/js/frontend/loonnode/menumaker.js"></script>
    <script src="/assets/website/js/frontend/loonnode/return-to-top.js"></script>
    <script src="/assets/website/js/frontend/loonnode/sticky-header.js"></script>
    <script src="/assets/website/js/frontend/loonnode/jquery.sticky.js"></script>
    <script src="/assets/website/js/frontend/loonnode/owl.carousel.min.js"></script>
    <script src="/assets/website/js/frontend/loonnode/multiple-carousel.js"></script>
    <script src="/assets/website/js/frontend/loonnode/aos.js"></script>
    <script>
    AOS.init({
        easing: 'linear',
        duration: 800,
    });
    </script>
    <script>
    AOS.init({
        disable: 'mobile'
    });
    </script>
    <script src="https://www.freeclashnode.com/assets/js/frontend/invite-url.js"></script><script src="/assets/website/js/frontend/G.js"></script>
</body>

</html>